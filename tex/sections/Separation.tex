\section{Separation}\label{sec:separation}
In this section we will describe the classes of inequalities that we separated as well as the algorithms used to do so.
Most of the separation routines are configurable in one way or another.
However, we will only explain the core algorithm in this section and leave the configuration parameters for \cref{subsec:run_configs}.

\subsection{Triangle inequalities}\label{subsec:triangle_separator}
In any complete graph $K_{n}$ there are only $3n(n-1)(n-2) = \mathcal{O}(n^{3})$ triangle inequalities.
We found that complete enumeration runs in acceptable time even for the biggest instances we tested.

\subsection{\texorpdfstring{$2$-partition}{2-partition} inequalities}\label{subsec:two_partition_separator}
The $2$-partition inequalities first described by \cite{grotschelFacetsCliquePartitioning1990} are a generalization of triangle inequalities.
\begin{definition}[$2$-partition inequalities, Section 4 of \cite{grotschelFacetsCliquePartitioning1990}]\label{def:2-partition_inequality}
	Let $K_{n} = (V_{n}, E_{n})$ be a complete graph.
	For every two disjoint nonempty subsets $S$ and $T$ of $V_{n}$, the inequality
	\begin{equation}\label{eq:2-partition_inequality}
		\sum_{s \in S}^{} \sum_{t \in T}^{} x_{st} - \sum_{\substack{s, s' \in S \\ s \neq s'}}^{} x_{ss'} - \sum_{\substack{t, t' \in T \\ t \neq t'}}^{} x_{tt'} \leq \func{min}( \lvert S \rvert, \lvert T \rvert )
	\end{equation}
	is called a $2$\textit{-partition inequality}.
\end{definition}
\begin{theorem}[Theorem 4.1 of \cite{grotschelFacetsCliquePartitioning1990}]
	For every $n \geq 3$ and every two nonempty subsets $S, T$ of $V_{n}$, the corresponding $2$-partition inequality is valid for $\mathscr{P}_{n}$.
	It defines a facet if and only if $\lvert  S \rvert \neq \lvert T \rvert$.
\end{theorem}

\cite{oostenCliquePartitioningProblem2001a} showed that separation for this class of inequalities is already \textsc{NP}-hard for any fixed $\lvert S \rvert$.
We therefore resorted to the heuristic separation routines described in \cite{grotschelFacetsCliquePartitioning1990}.

\subsection{Two-chorded odd cycle inequalities}\label{subsec:two_chorded_separator}
\begin{definition}[Two-chorded cycle inequalities, Section 5 of \cite{grotschelFacetsCliquePartitioning1990}]\label{def:2-chorded_cycle_inequality}
	Let $K_{n} = (V_{n}, E_{n})$ be a complete graph, let $5 \leq k \leq n$, and let $v: \Z_{k} \to \Z_{n}$ be injective.
	The \textit{two-chorded cycle inequality} with respect to $v$ is defined as
	\begin{equation}\label{eq:two-chorded_cycle_inequality}
		\sum_{i \in \Z_{k}}^{} x_{v_{i}v_{i+1}} - x_{v_{i}v_{i+2}} \leq \left\lfloor \frac{1}{2} k \right\rfloor
	\end{equation}
\end{definition}
\begin{theorem}[Theorem 5.1 of \cite{grotschelFacetsCliquePartitioning1990}]
	Let $K_{n}$ be a complete graph, let $5 \leq k \leq n$, and let $v: \Z_{k} \to \Z_{n}$ be injective.
	Then the two-chorded cycle inequality with respect to $v$ is valid for $\mathscr{P}_{n}$.
	It defines a facet if and only if $k$ is odd.
\end{theorem}

The naive attempt of separating the class of two-chorded odd cycle inequalities by enumeration quickly breaks down,
as there are 
\[
	\sum_{k=5 \text{ odd}}^{n} \binom{n}{k} \frac{k!}{2k} = \sum_{k = 5 \text{ odd}}^{n} \frac{n!}{(n-k)!2k}
\]
distinct two-chorded odd cycle inequalities for $K_{n}$.
\begin{proof}
	Analogous to the Proof of Proposition 20 in \cite{andresPolyhedralStudyLifted2022}.
\end{proof}

However, the class was shown to be seperable in polynomial time by \cite{mullerPartialOrderPolytope1996}.
Their paper is mainly concerned with the partial order polytope of a directed graph.
The algorithm described for separating \textit{odd closed walk} inequalities can be adapted to to separate a class of valid inequalities for the \CP polytope, that contains the class of two-chorded odd cycle inequalities.

In this paper, we are only interested in the class of two-chorded inequalities (and not this broader class) and will therefore repeat the argument given, but slightly adapted for this narrower class.

The crucial step in understanding the proof is the following:
Consider \cref{fig:support_graph_two-chorded_odd_cycle_inequality}.
We can obtain the left-hand side of the associated inequality by following the closed walk
\[
\mathrlap{\overbrace{\phantom{v_{0} v_{1} v_{2} v_{3} v_{4} v_{5} v_{6} v_{0}}}^{\text{cycle}}}
v_{0} v_{1} v_{2} v_{3} v_{4} v_{5} v_{6}
\mathrlap{\underbrace{\phantom{v_{0} v_{2} v_{4} v_{6} v_{1} v_{3} v_{5} v_{0}}}_{\text{two-chords}}}
v_{0} v_{2} v_{4} v_{6} v_{1} v_{3} v_{5} v_{0}
\]


and adding up the corresponding entries of the solution vector $x^{*}$ multiplied by $\pm 1$, respectively.
As long as we only traverse odd cycles and their two-chords (and not even ones) this will always produce the left-hand side of a two-chorded odd cycle inequality and, crucially, we do not need to know the $k$ in advance.
This suggests that we could try find some ‘special walk’ in an appropriate auxiliary graph $H$ where the structure of the graph prohibits us from ever taking walks along even cycles.

\begin{figure}[H]
	\centering
	\begin{tikzpicture}
        \def \n{6};
        \def \radius{1.5cm};
        \def \r{0.3cm};
        \foreach \i in {0,...,\n}{
			\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
			\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};
        }
        \foreach \i/\j in {0/1, 1/2, 2/3, 3/4, 4/5, 5/6, 6/0} {
			\draw[line width=0.2mm] (\i) -- (\j);
        }
        \foreach \i/\j in {0/2, 1/3, 2/4, 3/5, 4/6, 5/0, 6/1} {
			\draw[line width=0.2mm, dashed] (\i) -- (\j);
        }
	\end{tikzpicture}
	\caption[Support graph of a two-chorded odd cycle inequality]{Support graph of a two-chorded odd cycle inequality for $k$ = 7.
	Solid/Dashed lines represent variables with coefficient $+ / - 1$, respectively.}
	\label{fig:support_graph_two-chorded_odd_cycle_inequality}
\end{figure}

We will construct this special graph later and assume for now, that we can do so.
So restricting us to odd cycles, we can rewrite the right-hand side of \cref{eq:two-chorded_cycle_inequality}:
\begin{equation*}
	\sum_{i \in \Z_k} x_{v_i v_{i+1}} - x_{v_i v_{i+2}} \leq \frac{1}{2} (k-1)
\end{equation*}
By subtracting $\frac{1}{2}k$ from both sides and after rearranging we obtain:

\begin{equation*}
	\sum_{i \in \Z_k} \left( -x_{v_i v_{i+1}} + x_{v_i v_{i+2}} + \frac{1}{2} \right) \geq \frac{1}{2}
\end{equation*}
Now this inequality is independent of $k$ when we use the special graph $H$ described earlier to find the left-hand side.
Furthermore, adding some ‘weights’ and checking whether they are samller than some constant strongly hints at the use of a shortest-path algorithm.

We define the (weighted, directed, simple) axiliary graph $H = (V_{H}, E_{H})$ as follows:
For every (directed) pair $(i,j) \in V_{n}^{2}$ with $i \neq j$, we add the four nodes $u_{1}^{i,j}, u_{2}^{i,j}, v_{1}^{i,j}$ and $v_{2}^{i,j}$ to $V_{H}$ 
and the two arcs $(u_{1}^{i,j}, u_{2}^{i,j})$ and $(v_{1}^{i,j}, v_{2}^{i,j})$ to $E_{H}$.
We will call four such nodes a \textit{gadget} and the two edges inside a gadget \textit{inner-gadget edges}.
Furthermore for every (directed) triple $(i,j,k) \in V_{n}^{3}$ with $i,j,k$ pairwise distinct, we add the two arcs $(u_{2}^{i,j}, v_{1}^{j,k})$ and $(v_{2}^{i,j}, u_{i}^{j,k})$ to $E_{H}$, called \textit{inter-gadget edges}.
\cref{fig:aux_graph_K3} shows an example of the auxiliary graph for $K_{3}$.

\begin{figure}[H]
	\centering
	\begin{tikzpicture}
		\foreach \i/\j [count=\gc from 0] in {0/1, 1/2, 2/0, 0/2, 2/1, 1/0}
			\foreach \io in {1,2}
				\foreach \uv [count=\uvc from 0] in {u,v}{
					\node[vertex]
					(\uv\io\i\j) 
					at ({ifthenelse(\gc < 3, 0, 1)*3.5+ \uvc*1.5}, -{Mod(\gc,3)*3.5 + ifthenelse(\io == 2, 0, 1.5)})
					{$\uv_{\io}^{\i, \j}$};
			}
		\foreach \i/\j in {0/1, 0/2, 1/0, 1/2, 2/0, 2/1}{
			\draw[-latex] (u1\i\j) edge[line width=0.75pt] (u2\i\j);
			\draw[-latex] (v1\i\j) edge[line width=0.75pt] (v2\i\j);
		}
		\foreach \i/\j/\k [count=\cc from 1] in {0/1/2, 1/2/0, 2/0/1, 0/2/1, 2/1/0, 1/0/2}{
			\pgfmathsetmacro{\outdiruv}{ifthenelse(Mod(\cc,3) == 0, "north east", "south"}
			\pgfmathsetmacro{\outdirvu}{ifthenelse(Mod(\cc,3) == 0, "north west", "south"}
			\pgfmathsetmacro{\indiruv}{ifthenelse(Mod(\cc,3) == 0, "south west", "north"}
			\pgfmathsetmacro{\indirvu}{ifthenelse(Mod(\cc,3) == 0, "south east", "north"}
			\pgfmathsetmacro{\looseness}{ifthenelse(Mod(\cc,3) == 0, 0.2, 1}
			\draw[-latex] (u2\i\j) edge[line width=0.75pt, dashed, out=\outdiruv, in=\indiruv, looseness=\looseness] (v1\j\k);
			\draw[-latex] (v2\i\j) edge[line width=0.75pt, dashed, out=\outdirvu, in=\indirvu, looseness=\looseness] (u1\j\k);
		}
	\end{tikzpicture}
	\caption[Auxiliary graph $H$ for $K_3$]{The auxiliary graph for the complete graph $K_{3}$.
	Inner-gadget edges are shown as solid lines and inter-gadget edges are shown as dashed lines.}
	\label{fig:aux_graph_K3}
\end{figure}

Note that $H$ connected for any $K_{n}$ with $n \geq 4$, but showing such a graph in full detail is rather confusing.

\begin{figure}[H]
	\centering
	\resizebox{\textwidth}{!}{
			\begin{tikzpicture}
        \def \n{6};
		\foreach \i in {0, ..., \n}
			\foreach \j in {0, ..., \n}{

			\ifthenelse{\i = \j}{}{

			\foreach \io in {1,2}
				\foreach \uv [count=\uvc from 0] in {u,v}{
					\node[vertex]
					(\uv\io\i\j) 
					at ({\i*3 + \uvc*1.25}, -{\j*3 + ifthenelse(\io == 2, 0, 1.25)}) %{};
					{$\uv_{\io}^{\i, \j}$};
				}
			\draw[-latex] (u1\i\j) -- (u2\i\j);
			\draw[-latex] (v1\i\j) -- (v2\i\j);
			}

			}
		\foreach \i/\j/\k [count=\counter from 0] in {0/1/2, 1/2/3, 2/3/4, 3/4/5, 4/5/6, 5/6/0, 6/0/1}{
			\pgfmathsetmacro{\startnode}{ifthenelse(Mod(\counter,2) == 0, "u", "v")}
			\pgfmathsetmacro{\endnode}{ifthenelse(Mod(\counter,2) == 0, "v", "u")}
			\pgfmathsetmacro{\indir}{ifthenelse(\j == 6, "west", "north")}
			\pgfmathsetmacro{\outdir}{ifthenelse(\j == 6, "east", "south")}
			\pgfmathsetmacro{\looseness}{ifthenelse(\j == 0, 0.25, ifthenelse(\j == 6, 0.25, 0.5))}
			\draw[-latex] (\startnode2\i\j) edge[color=cdblue, out=\outdir, in=\indir, looseness=\looseness] (\endnode1\j\k);
		}
		\foreach \i/\j [count=\counter from 0] in {0/1, 1/2, 2/3, 3/4, 4/5, 5/6, 6/0}{
			\pgfmathsetmacro{\uv}{ifthenelse(Mod(\counter,2) == 0, "u", "v")}
			\draw[-latex] (\uv1\i\j) edge[color=cdblue] (\uv2\i\j);

		}
	\end{tikzpicture}}
	\caption[Walk in $H$]{The auxiliary graph $H$ for $K_{7}$.
	The $u_{1}^{0,1}v_{1}^{0,1}$-walk corrsponding to the inequality in \cref{fig:support_graph_two-chorded_odd_cycle_inequality} is shown in blue.
	All other inter-gadget weights are left out for clarity.}
	\label{fig:walk_in_auxiliary_graph}
\end{figure}

\subsection{Half-chorded odd cycle inequalities}\label{subsec:half_chorded_separator}

\begin{definition}[Half-chorded odd cycle inequalities]\label{def:half-chorded}
Let $5 \leq k \leq n$ with $k$ odd, let $d = \frac{k-1}{2}$, and let $v: \Z_{k} \to \Z_{n}$ be injective.
The \textit{half-chorded odd cycle inequality} with respect to $v$ is defined as
\begin{equation}\label{eq:half-chorded}
	\sum_{i \in \Z_{k}}^{} (x_{v_{i} v_{i+1}} - x_{v_{i} v_{i+d} }) \leq k - 3
\end{equation}
\end{definition}
\begin{note}
	The half-chords $v_{i}v_{i+d}$ for $i \in \Z_{k}$ also form a cycle in $K_{n}$, and the edges $v_{i}v_{i+1}$ are the $2$-chords of that cycle.
\end{note}
We can therefore rewrite this equation as
\begin{equation*}
\sum_{i \in \Z_{k}}^{} (x_{w_{i}w_{i+2}} - x_{w_{i}w_{i+1}}) \leq k-3
\end{equation*}
where $w: \Z_{k} \to \Z_{n}, i \mapsto v_{i \cdot d}$.
By subtracting $k$ from both sides and multiplying by $-1$ we obtain:
\begin{equation*}
	\sum_{i \in \Z_{k}}^{} \left( -x_{w_{i}w_{i+2}} + x_{w_{i}w_{i+1}} + 1 \right) \geq 3.
\end{equation*}

Now for every tuple $(i,j) \in V^{2}$ we set the weights of the arcs $(u_{1}^{i,j}, u_{2}^{i,j})$ and $(v_{1}^{i,j}, v_{2}^{i,j})$ to $x_{ij}$.
And for every triple $(i,j,k) \in V^{3}$ we set the weight of the arcs $(u_{2}^{i,j}, v_{1}^{j,k})$ and $(v_{2}^{i,j}, u_{1}^{j,k})$ to $1-x_{ik}$.
Then, $x$ violates a half-chorded odd cycle inequality iff for any $(i,j) \in V^{2}$ there exists a $u_{1}^{i,j}v_{1}^{i,j}$-walk in $H$ with weighted lenght stricly less than 3.
