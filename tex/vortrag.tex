% !TEX TS-program = lualatex
\documentclass{beamer}

\input{preamble.tex}
\usepackage{tudscrcolor}
\usepackage{booktabs}
\usepackage{csvsimple}

% Beamer styling
\usetheme{Dresden}
\setbeamertemplate{itemize items}[circle]
%\setbeameroption{hide notes} % Only slides
\setbeameroption{show notes on second screen=bottom} % notes and slides
\AtBeginSection[]{
  \begin{frame}
  \vfill
  \centering
  \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
    \usebeamerfont{title}\insertsectionhead\par%
  \end{beamercolorbox}
  \vfill
  \end{frame}
}
\renewcommand{\arraystretch}{1.3}


\author{Maximilian Moeller}
\title{Evaluation of separation routines for some classes of inequalities of the Clique Partitioning polytope}
\subtitle{Colloquium “Großer Beleg”}
\date{21.11.2023}

\begin{document}
	
\frame{\titlepage}

\begin{frame}
\frametitle{Agenda}
\tableofcontents
\end{frame}

\section{Introduction}
\begin{frame}
\frametitle{Clique Partitioning}
\begin{columns}
\begin{column}{0.5\textwidth}
\begin{itemize}
	\item clustering based on pairwise similarities
\item framework for aggregation of binary relations \cite{grotschelFacetsCliquePartitioning1990} \cite{wakabayashiAggregationBinaryRelations1986}
\item useful in biology, medicine \cite{presbergerSegmentationClusteringOrganoids2023}
\end{itemize}
	\note[item]{biology: taxonomy of animals (\eg whales and dolphins)}
	\note[item]{medicine: clustering of organoids in light microscopy images}
	\note[item]{probably also operations research}
\end{column}
\begin{column}{0.5\textwidth}  %%<--- here
	\centering
	\begin{tikzpicture}
        \def \n{8};
        \def \radius{1.5cm};
        \def \r{0.3cm};
        \foreach \i in {0,...,\n}{
			\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
			\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};
        }
        \foreach \i in {0,...,\n}{
            \foreach \j in {\i,...,\n}{
                \draw[dotted, gray] (\i) -- (\j);
        	}
        }
        \foreach \i/\j in {1/8, 1/3, 1/5, 8/3, 8/5, 3/5} {
			\draw[line width=0.2mm] (\i) -- (\j);
        }
        \foreach \i/\j in {4/6, 4/7, 6/7} {
			\draw[line width=0.2mm] (\i) -- (\j);
        }
	\end{tikzpicture}
\end{column}
\end{columns}
\end{frame}

\begin{frame}
	\frametitle{Clique Partitioning}
	\begin{columns}
		\begin{column}{0.5\textwidth}
		\onslide<1->{
		\begin{definition}
			Given a graph $G=(V,E)$, a subset of edges $A \subseteq E$ is called a \textit{clique partitioning of $G$} if there exists a partition $\Gamma = \left\{ W_1, W_2, \ldots, W_k \right\}$ of $V$ such that
			\[
				A = \bigcup_{i=1}^k \left\{ (u,v) \in E \mid u,v \in W_i \right\}.
			\]
		\end{definition}}
		\note[item]{\textcolor{red}{show} which partition is induced}
		\note[item]{typically only complete graphs considered (indicates for every pair of nodes)}
		\note[item]{then one-to-one corresponds to an equivalence relation}
		\note[item]{induces complete subgraphs \textit{clique} partitioning}
		\end{column}
		\begin{column}{0.5\textwidth}  %%<--- here
			\centering
			\begin{tikzpicture}
			\onslide<1->{
		        \def \n{8};
		        \def \radius{1.5cm};
		        \def \r{0.3cm};
		        \foreach \i in {0,...,\n}{
					\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
					\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};
		        }
		        \foreach \i in {0,...,\n}{
		            \foreach \j in {\i,...,\n}{
		                \draw[dotted, gray] (\i) -- (\j);
		        	}
			}}
			\only<2>{
		        \foreach \i/\j in {1/8, 1/3, 1/5, 8/3, 8/5, 3/5} {
					\draw[line width=0.2mm] (\i) -- (\j);
		        }
		        \foreach \i/\j in {4/6, 4/7, 6/7} {
					\draw[line width=0.2mm] (\i) -- (\j);
			}}
			\end{tikzpicture}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}
	\frametitle{The Clique Partitioning Problem}	
	Input: complete graph $K_{n} = (V_{n}, E_{n})$ and edge costs $w \in \R^{E_{n}}$

	Compute: a clique partitioning of minimum weight

	\begin{align*}
	\min && &\sum_{e \in E_{n}} w_{e} x_{e} \\[1.5ex]
	\text{s.t.} && &\forall e \in E_{n} \colon x_{e} \in \left\{ 0,1 \right\}  \\
				&& &x \text{ characterizes a clique partitioning} \\
	\end{align*}
	\note[item]{characterize clique partitionings by binary vectors}
	\note[item]{1 means it is in the clique partitioning and 0 means it is not in it}
	\note[item]{exactly opposite to \textcolor{red}{multicut} (equivalent problem)}
\end{frame}


\begin{frame}
	\frametitle{The Clique Partitioning Problem}	
	\begin{columns}
		\begin{column}{0.5\textwidth}
			\begin{itemize}
				\item \textsc{NP}-complete \cite{wakabayashiAggregationBinaryRelations1986}
				\item<2-> Trivial cases:
					\onslide<3->{
					\begin{itemize}
						\item<3-> $w \geq \bm{0}$	
						\item<4-> $w \leq \bm{0}$
						\item<5-> $w$ induces cliques
					\end{itemize}}
			\end{itemize}
			\note[item]{blue drawn are edges with negative weights, all others non-negative}
			\note[item]{interesting instances need to have ‘conflicts’}
		\end{column}
		\begin{column}{0.5\textwidth}
			\onslide<3->{
			\begin{tikzpicture}
		        \def \n{8};
		        \def \radius{1.5cm};
		        \def \r{0.3cm};
		        \foreach \i in {0,...,\n}{
					\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
					\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};
		        }
		        \foreach \i in {0,...,\n}{
		            \foreach \j in {\i,...,\n}{
						\only<3>{\draw[gray, dotted] (\i) -- (\j);}
						\only<5>{\draw[gray] (\i) -- (\j);}
		        	}
			}
			\only<4>{
		        \foreach \i in {0,...,\n}{
		            \foreach \j in {\i,...,\n}{
		                \draw (\i) -- (\j);
		    	}
			}}
			\only<5>{
		        \foreach \i/\j in {1/8, 1/3, 1/5, 8/3, 8/5, 3/5} {
					\draw[line width=0.4mm, color=cdblue] (\i) -- (\j);
		        }
		        \foreach \i/\j in {4/6, 4/7, 6/7} {
					\draw[line width=0.4mm, color=cdblue] (\i) -- (\j);
			}}}
			\end{tikzpicture}
		\end{column}
	\end{columns}
\end{frame}


\begin{frame}
	\frametitle{An ILP-formulation of Clique Partitioning}	
	\note[item]{we want to make use of (I)LP techniques: linear inequalities}
	characteristic vectors $x$ \onslide<2->{need to satisfy \textit{triangle inequalities} ($i,j,k \in V_{n}$, pairwise distinct) \cite{grotschelFacetsCliquePartitioning1990}}
	\note[item]{explain support graph: left hand side can be drawn as graph, dotted negative, solid positive}
	\note[item]{triangle inequalities ensure transitivity}
	\note[item]{for the same $i,j,k$ there are actually three triangles (\textcolor{red}{show})}
\begin{align*}
	\onslide<2->{x_{ij} + x_{jk} - x_{ik} &\leq 1\\}
	\onslide<3->{x_{ij} - x_{jk} + x_{ik} &\leq 1\\}
	\onslide<3->{- x_{ij} + x_{jk} + x_{ik} &\leq 1\\}
\end{align*}
\vspace*{-2\baselineskip}
\onslide<2->{
\begin{figure}
	\centering
	\begin{subfigure}[b]{0.3\textwidth}
		\centering
			\begin{tikzpicture}
			    \def \n{2};
			    \def \radius{1.5cm};
			    \def \r{0.3cm};
			    \foreach \i/\j in {0/i,1/j,2/k}{
					\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
					\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};
			    }
			    \draw (1) -- (2);
			    \draw[dashed] (2) -- (0);
			    \draw (1) -- (0);
			\end{tikzpicture}
	\end{subfigure}
	\hfill
	\only<3->{
	\begin{subfigure}[b]{0.3\textwidth}
		\centering
			\begin{tikzpicture}
			    \def \n{2};
			    \def \radius{1.5cm};
			    \def \r{0.3cm};
			    \foreach \i/\j in {0/i,1/j,2/k}{
					\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
					\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};
			    }
			    \draw[dashed] (1) -- (2);
			    \draw (2) -- (0);
			    \draw (1) -- (0);
			\end{tikzpicture}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.3\textwidth}
		\centering
			\begin{tikzpicture}
			    \def \n{2};
			    \def \radius{1.5cm};
			    \def \r{0.3cm};
			    \foreach \i/\j in {0/i,1/j,2/k}{
					\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
					\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};
			    }
			    \draw (1) -- (2);
			    \draw (2) -- (0);
			    \draw[dashed] (1) -- (0);
			\end{tikzpicture}
	\end{subfigure}}
\end{figure}}
\end{frame}

\begin{frame}
\frametitle{The Task}
\note[item]{original task: branch-and-cut algorithm, \ie solving the ILP}
\note[item]{consists of multiple parts: \textbf{cutting planes for bounds}, finding good solutions and branch management}
\onslide<2->{
focus on cutting plane procedure:
\begin{itemize}
	\item<2-> solve LP relaxation of the problem
	\item<3-> tighten the solution iteratively
	\note[item]{explain overall iteration procedure}
	\item<4-> hopefully arrive at integral solution
	\item<5-> ???
	\item<5-> profit
\end{itemize}}
\note[item]{even if not integral, a few percent off might be good for practical use}
\note[item]{however, no guarantee to arrive at integral or within a constant factor}
\end{frame}

\section{Separating Inequalities}


\begin{frame}
	\frametitle{Ingredients}	
	\begin{itemize}
		\item<1-> classes of facet-defining linear inequalities
		\item<2-> algorithms for separating them
		\item<3-> data to test on (next section)
	\end{itemize}
	\note[item]{explain: what is separation (check (and produce))}
	\note[item]{explain: facet-defining}
\end{frame}


\begin{frame}
	\frametitle{Triangle Inequalities (\texttt{Δ})}	
	Using complete enumeration $\mathcal{O}(n^{3})$
	\note[item]{Separation algorithms: separators}
	\note[item]{separators get abbreviations}

	Four variations
	\vspace*{2\baselineskip}
\onslide<2>{
\begin{table}
	\begin{tabular}{@{}lcc@{}}
		\toprule
		abbreviation & \texttt{maxcut} & \texttt{var\_once} \\
		\midrule
		\texttt{Δ} & 400 & – \\ 
		$\texttt{Δ}_{\infty}$ & $\infty$ & – \\
		$\texttt{Δ}^{\leq 1}$ & 400 & \checkmark \\
		$\texttt{Δ}_{\infty}^{\leq 1}$ & $\infty$ & \checkmark \\
		\bottomrule
	\end{tabular}
	
	\note[item]{\texttt{maxcut} is for limiting lp size}
	\note[item]{\texttt{var\_once} is for solving the graph evenly}
\end{table}}
\end{frame}

\begin{frame}
	\frametitle{2-Partition Inequalities}	
	\note[item]{Generalization of triangle inequalities}
	Let $S, T \subseteq V_{n} $ disjoint.

	2-\textit{partition inequality} \quad ($\left[ S,T \right]$-inequality) \cite{grotschelFacetsCliquePartitioning1990}
	\[
		\sum_{s \in S}^{} \sum_{t \in T}^{} x_{st} - \sum_{\substack{s, s' \in S \\ s \neq s'}}^{} x_{ss'} - \sum_{\substack{t, t' \in T \\ t \neq t'}}^{} x_{tt'} \leq \func{min}( \lvert S \rvert, \lvert T \rvert )
	\]
	\vspace*{-2\baselineskip}
	\onslide<2->{
	\begin{columns}
				\begin{column}{0.5\textwidth}
					facet defining for $\lvert S \rvert \neq \lvert  T \rvert$
				\end{column}
				\begin{column}{0.5\textwidth}
			\begin{tikzpicture}
        \def \n{4};
        \def \radius{1.5cm};
        \def \r{0.3cm};
        \foreach \i in {0,...,\n}{
			\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
			\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};
        }
        \foreach \i/\j in {0/1, 1/2, 0/2, 3/4} {
			\draw[dashed, line width=0.35mm] (\i) -- (\j);
        }
        \foreach \i/\j in {0/3, 0/4, 1/3, 1/4, 2/3, 2/4} {
			\draw (\i) -- (\j);
        }
	\end{tikzpicture}}
		\end{column}
	\end{columns}
\end{frame}


\begin{frame}
	\frametitle{Separation of 2-Partition Inequalities (\texttt{st})}	
	\begin{itemize}
		\item<1-> already \textsc{NP}-hard for any fixed $\lvert S \rvert$ \cite{oostenCliquePartitioningProblem2001a}
		\item<2-> using two heuristics: $\texttt{st}^{1}$ and $\texttt{st}^{2}$ from \cite{grotschelCuttingPlaneAlgorithm1989}
		\item<3-> only search for constraints with $\lvert S \rvert = 1$
	\end{itemize}
	\note[item]{no use in using approximation if it is np-hard again}
	\note[item]{not explaining details, involve random choosing of an order of some nodes. Thus re-run three times.}
\end{frame}


\begin{frame}
	\frametitle{Two-Chorded Odd Cycle Ineuqalities}	
	Let $5 \leq k \leq n$ and $v: \Z_{k} \to \Z_{n}$ injective

	\textit{two-chorded odd cycle inequality} \cite{grotschelFacetsCliquePartitioning1990}
	\[
		\sum_{i \in \Z_{k}}^{} x_{v_{i}v_{i+1}} - x_{v_{i}v_{i+2}} \leq \left\lfloor \frac{1}{2} k \right\rfloor
	\]

	\vspace*{-1\baselineskip}
	\onslide<2->{
	\begin{columns}
				\begin{column}{0.5\textwidth}
					facet defining for $k$ odd
				\end{column}
				\begin{column}{0.5\textwidth}
	\begin{tikzpicture}
        \def \n{6};
        \def \radius{1.5cm};
        \def \r{0.3cm};
        \foreach \i in {0,...,\n}{
			\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
			\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};
        }
        \foreach \i/\j in {0/1, 1/2, 2/3, 3/4, 4/5, 5/6, 6/0} {
			\draw[line width=0.2mm] (\i) -- (\j);
        }
        \foreach \i/\j in {0/2, 1/3, 2/4, 3/5, 4/6, 5/0, 6/1} {
			\draw[line width=0.2mm, dashed] (\i) -- (\j);
        }
	\end{tikzpicture}
	\end{column}
\end{columns}}
\note[item]{separable in polytime shown by müller 1996}
\note[item]{technique hard to motivate}
\end{frame}


\begin{frame}
	\frametitle{Separating Two-Chorded Odd Cycle Inequalities (\texttt{two})}
	\begin{columns}
		\begin{column}{0.5\textwidth}
	\begin{tikzpicture}
        \def \n{6};
        \def \radius{1.5cm};
        \def \r{0.3cm};
        \foreach \i in {0,...,\n}{
			\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
			\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};
        }
        \foreach \i/\j in {0/1, 1/2, 2/3, 3/4, 4/5, 5/6, 6/0} {
			\draw[line width=0.2mm] (\i) -- (\j);
        }
        \foreach \i/\j in {0/2, 1/3, 2/4, 3/5, 4/6, 5/0, 6/1} {
			\draw[line width=0.2mm, dashed] (\i) -- (\j);
        }
	\end{tikzpicture}
		\end{column}
		\begin{column}{0.6\textwidth}
			\only<1>{\cite{mullerPartialOrderPolytope1996}}
			\only<2>{
\[
\mathrlap{\overbrace{\phantom{v_{0} v_{1} v_{2} v_{3} v_{4} v_{5} v_{6} v_{0}}}^{\text{cycle}}}
v_{0} v_{1} v_{2} v_{3} v_{4} v_{5} v_{6}
\mathrlap{\underbrace{\phantom{v_{0} v_{2} v_{4} v_{6} v_{1} v_{3} v_{5} v_{0}}}_{\text{two-chords}}}
v_{0} v_{2} v_{4} v_{6} v_{1} v_{3} v_{5} v_{0}
\]}
\only<3>{
\[
	\sum_{i \in \Z_{k}}^{} x_{v_{i}v_{i+1}} - x_{v_{i}v_{i+2}} \leq \left\lfloor \frac{1}{2} k \right\rfloor
\]
	For odd $k$
\[
	\sum_{i \in \Z_k} x_{v_i v_{i+1}} - x_{v_i v_{i+2}} \leq \frac{1}{2} (k-1)
\]
After rearranging
\[
	\sum_{i \in \Z_k} \left( \frac{1}{2} -x_{v_i v_{i+1}} + x_{v_i v_{i+2}} \right) \geq \frac{1}{2}
\]
}
\end{column}
	\end{columns}
	\note[item]{following an odd cycle and summing edges by +- 1 gives left hand side}
	\note[item]{we do not need to know the $k$ to know that we get a lhs}
	\note[item]{maybe we can also rewrite the rhs independent of $k$}
	\note[item]{new problem distinguish even from odd cycles -> hints at auxiliary graph}
\end{frame}


\begin{frame}
	\frametitle{Auxiliary Graph $H = (V_{H}, E_{H})$}
	\only<1-2>{
	\begin{columns}
	\begin{column}{0.5\textwidth}
		For every pair $(i,j) \in V_{n}^{2}$ with $i \neq j$:
		\onslide<2>{\begin{align*}
			V_{H} &\coloneqq V_{H} \cup \big\{ u_{1}^{i,j}, u_{2}^{i,j}, \hat{u}_{1}^{i,j}, \hat{u}_{2}^{i,j} \big\} \\
			E_{H} & \coloneqq E_{H} \cup \left\{ (u_{1}^{i,j}, u_{2}^{i,j}), (\hat{u}_{1}^{i,j}, \hat{u}_{2}^{i,j}) \right\}
	\end{align*}}
	\end{column}
	\begin{column}{0.5\textwidth}
		\centering
		\onslide<2>{
	\begin{tikzpicture}
		\foreach \i/\j [count=\gc from 0] in {0/1}
			\foreach \io in {1,2}
				\foreach \uv [count=\uvc from 0] in {u,v}{
					\pgfmathsetmacro{\desc}{ifthenelse(\uvc == 0, "$u_{\io}^{\i, \j}$", "$\hat{u}_{\io}^{\i, \j}$")}
					\node[vertex]
					(\uv\io\i\j) 
					at ({ifthenelse(\gc < 3, 0, 1)*2.75 + \uvc*1.5}, {Mod(\gc,3)*3.5 + ifthenelse(\io == 2, 0, 1.5)})
					{\desc};
			}
		\foreach \i/\j in {0/1}{
			\draw[-latex] (u1\i\j) edge[line width=0.75pt] (u2\i\j);
			\draw[-latex] (v1\i\j) edge[line width=0.75pt] (v2\i\j);
		}
	\end{tikzpicture}}
			\end{column}
		\end{columns}
	}
	\only<3-4>{
	\begin{columns}
	\begin{column}{0.5\textwidth}
		For every triple $(i,j,k) \in V_{n}^{3}$ with $i,j,k$ pairwise distinct:
		\onslide<4>{\begin{align*}
			E_{H} & \coloneqq E_{H} \cup \left\{ (u_{2}^{i,j}, \hat{u}_{1}^{j,k}), (\hat{u}_{2}^{i,j}, u_{1}^{j,k}) \right\}
	\end{align*}}
					\end{column}
	\begin{column}{0.5\textwidth}
	\centering
	\onslide<4>{
	\begin{tikzpicture}
		\foreach \i/\j [count=\gc from 0] in {0/1, 1/2}
			\foreach \io in {1,2}
				\foreach \uv [count=\uvc from 0] in {u,v}{
					\pgfmathsetmacro{\desc}{ifthenelse(\uvc == 0, "$u_{\io}^{\i, \j}$", "$\hat{u}_{\io}^{\i, \j}$")}
					\node[vertex]
					(\uv\io\i\j) 
					at ({ifthenelse(\gc < 3, 0, 1)*2.75 + \uvc*1.5}, {-Mod(\gc,3)*3.5 + ifthenelse(\io == 2, 0, 1.5)})
					{\desc};
			}
		\foreach \i/\j in {0/1, 1/2}{
			\draw[-latex] (u1\i\j) edge[line width=0.75pt] (u2\i\j);
			\draw[-latex] (v1\i\j) edge[line width=0.75pt] (v2\i\j);
		}
		\foreach \i/\j/\k [count=\cc from 1] in {0/1/2}{
			\pgfmathsetmacro{\outdiruv}{ifthenelse(Mod(\cc,3) == 0, "south west", "south"}
			\pgfmathsetmacro{\outdirvu}{ifthenelse(Mod(\cc,3) == 0, "north west", "south"}
			\pgfmathsetmacro{\indiruv}{ifthenelse(Mod(\cc,3) == 0, "north east", "north"}
			\pgfmathsetmacro{\indirvu}{ifthenelse(Mod(\cc,3) == 0, "south east", "north"}
			\pgfmathsetmacro{\looseness}{ifthenelse(Mod(\cc,3) == 0, 0.2, 1}
			\draw[-latex] (u2\i\j) edge[line width=0.75pt, dashed, out=\outdiruv, in=\indiruv, looseness=\looseness] (v1\j\k);
			\draw[-latex] (v2\i\j) edge[line width=0.75pt, dashed, out=\outdirvu, in=\indirvu, looseness=\looseness] (u1\j\k);
		}
	\end{tikzpicture}}
	\end{column}
	\end{columns}
	}
	\note[item]{bipartide graph can distinguish between odd and even walks}
	\note[item]{}
\end{frame}


\begin{frame}
	\frametitle{Weights for the auxiliary graph}
		\begin{equation*}
			\sum_{i \in \Z_k} \biggl( \underbrace{ \frac{1}{2} -x_{v_i v_{i+1}} }_{\text{inner-gadget weights}} + \underbrace{x_{v_i v_{i+2}}}_{\text{inter-gadget weights}} \biggr) \geq \frac{1}{2}
		\end{equation*}
	\note[item]{no negative cycles as long as triangle inequalities are satisfied! (müller)}
\end{frame}


\begin{frame}
	\begin{columns}
		\begin{column}{0.5\textwidth}
	\begin{tikzpicture}
        \def \n{6};
        \def \radius{1.5cm};
        \def \r{0.3cm};
        \foreach \i in {0,...,\n}{
			\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
			\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};
        }
        \foreach \i/\j in {0/1, 1/2, 2/3, 3/4, 4/5, 5/6, 6/0} {
			\draw[line width=0.2mm] (\i) -- (\j);
        }
        \foreach \i/\j in {0/2, 1/3, 2/4, 3/5, 4/6, 5/0, 6/1} {
			\draw[line width=0.2mm, dashed] (\i) -- (\j);
        }
	\end{tikzpicture}
		\end{column}
		\begin{column}{0.6\textwidth}
		\centering
		\resizebox{0.95\textwidth}{!}{
			\begin{tikzpicture}
        \def \n{6};
		\foreach \i in {0, ..., \n}
			\foreach \j in {0, ..., \n}{

			\ifthenelse{\i = \j}{}{

			\foreach \io in {1,2}
				\foreach \uv [count=\uvc from 0] in {u,v}{
					\pgfmathsetmacro{\desc}{ifthenelse(\uvc == 0, "$u_{\io}^{\i, \j}$", "$\hat{u}_{\io}^{\i, \j}$")}
					\node[vertex]
					(\uv\io\i\j) 
					at ({\i*3 + \uvc*1.25}, -{\j*3 + ifthenelse(\io == 2, 0, 1.25)}) %{};
					{\desc};
				}
			\draw[-latex] (u1\i\j) -- (u2\i\j);
			\draw[-latex] (v1\i\j) -- (v2\i\j);
			}

			}
		\foreach \i/\j/\k [count=\counter from 0] in {0/1/2, 1/2/3, 2/3/4, 3/4/5, 4/5/6, 5/6/0, 6/0/1}{
			\pgfmathsetmacro{\startnode}{ifthenelse(Mod(\counter,2) == 0, "u", "v")}
			\pgfmathsetmacro{\endnode}{ifthenelse(Mod(\counter,2) == 0, "v", "u")}
			\pgfmathsetmacro{\indir}{ifthenelse(\j == 6, "west", "north")}
			\pgfmathsetmacro{\outdir}{ifthenelse(\j == 6, "east", "south")}
			\pgfmathsetmacro{\looseness}{ifthenelse(\j == 0, 0.25, ifthenelse(\j == 6, 0.25, 0.5))}
			\draw[-latex] (\startnode2\i\j) edge[line width=0.75pt, color=cdblue, out=\outdir, in=\indir, looseness=\looseness] (\endnode1\j\k);
		}
		\foreach \i/\j [count=\counter from 0] in {0/1, 1/2, 2/3, 3/4, 4/5, 5/6, 6/0}{
			\pgfmathsetmacro{\uv}{ifthenelse(Mod(\counter,2) == 0, "u", "v")}
			\draw[-latex] (\uv1\i\j) edge[line width=0.75pt, color=cdblue] (\uv2\i\j);

		}
\end{tikzpicture}}

\end{column}
\end{columns}
\note[item]{each violated odd-cycle inequality corresponds to a u,uhat walk (same gadget)}
\end{frame}

\begin{frame}
	\frametitle{Dimensions of $H$}
\begin{align*}
	\lvert V_{H} \rvert &= 4 n(n-1) = 4n^{2} - 4n \\
	\lvert E_{H} \rvert &= \underbrace{2 n(n-1)}_{\text{inner-gadget edges}} + \underbrace{2 n(n-1)(n-2)}_{\text{inter-gadget edges}} = 2n^{3} - 4n^{2} + 2n \\
\end{align*}
\onslide<2->{
Shortest path-algorithms
\begin{itemize}
	\item<2-> Floyd-Warshall $\mathcal{O}(\lvert V \rvert^3) = \mathcal{O}(n^{6})$\onslide<4->{, $\mathcal{O}(\lvert V \rvert^{2}) = \mathcal{O}(n^{4})$ space!}
	\item<3-> Belman-Ford: $\mathcal{O}(\lvert V_{H} \rvert \cdot \lvert E_{H} \rvert) = \mathcal{O}(n^{5})$, $\mathcal{O}(n^{2})$ many times\onslide<4->{, $\mathcal{O}(\lvert V \rvert) = \mathcal{O}(n^{2})$ space}
\end{itemize}
}
	\note[item]{size has effect on choice of shortest path}
	\note[item]{floyd-warshall takes 80GB of memory on largest instances}
	\note[item]{we can terminate belman-ford early -> after 15 minutes}
\end{frame}


\begin{frame}
	\frametitle{Half-Chorded Odd Cycle Ineuqalities}	
	Let $5 \leq k \leq n$, let $d = \frac{k-1}{2}$ and $v: \Z_{k} \to \Z_{n}$ injective

	\textit{half-chorded odd cycle inequality} \cite{andresPolyhedralStudyLifted2022}
	\[
		\sum_{i \in \Z_{k}}^{} (x_{v_{i} v_{i+1}} - x_{v_{i} v_{i+d} }) \leq k - 3
	\]

	\vspace*{-1\baselineskip}
	\onslide<2->{
	\begin{columns}
				\begin{column}{0.5\textwidth}
					facet defining for $k$ odd
				\end{column}
				\begin{column}{0.5\textwidth}
	\begin{tikzpicture}
        \def \n{6};
        \def \radius{1.5cm};
        \def \r{0.3cm};
        \foreach \i in {0,...,\n}{
			\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
			\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};
        }
        \foreach \i/\j in {0/1, 1/2, 2/3, 3/4, 4/5, 5/6, 6/0} {
			\draw[line width=0.2mm] (\i) -- (\j);
        }
        \foreach \i/\j in {0/3, 1/4, 2/5, 3/6, 4/0, 5/1, 6/2} {
			\draw[line width=0.2mm, dashed] (\i) -- (\j);
        }
	\end{tikzpicture}
	\end{column}
\end{columns}}
\end{frame}


\begin{frame}
	\frametitle{Separating Half-Chorded Odd Cycle Ineuqalities (\texttt{half})}	
	\begin{columns}
		\begin{column}{0.4\textwidth}
			\centering
	\begin{tikzpicture}
        \def \n{6};
        \def \radius{1.5cm};
        \def \r{0.3cm};
        \foreach \i in {0,...,\n}{
			\node[vertex] (\i) at ({\i/(\n+1)*360+90}:\radius) {};
			\only<1>{\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\i}$};}
			\only<2->{
			\pgfmathtruncatemacro{\newlabel}{Mod(5*\i,7)}
			\node at ({\i/(\n+1)*360+90}:\radius+\r) {$v_{\newlabel}$};}
        }
        \foreach \i/\j in {0/1, 1/2, 2/3, 3/4, 4/5, 5/6, 6/0} {
			\draw[line width=0.2mm] (\i) -- (\j);
        }
        \foreach \i/\j in {0/3, 1/4, 2/5, 3/6, 4/0, 5/1, 6/2} {
			\draw[line width=0.2mm, dashed] (\i) -- (\j);
        }
	\end{tikzpicture}
		
		\end{column}
		\begin{column}{0.6\textwidth}
			\only<1-2>{
			\[
				\sum_{i \in \Z_{k}}^{} (x_{v_{i} v_{i+1}} - x_{v_{i} v_{i+d} }) \leq k - 3
			\]}
			\only<2-3>{
			After relabeling
			\[
				\sum_{i \in \Z_{k}}^{} (x_{v'_{i}v'_{i+2}} - x_{v'_{i}v'_{i+1}}) \leq k-3
			\]}
			\only<3-4>{
			After rearranging
			\[
				\sum_{i \in \Z_{k}}^{} \Bigl( \underbrace{x_{v'_{i}v'_{i+1}}}_{\text{inner-gadget}} + \underbrace{1 -x_{v'_{i}v'_{i+2}}}_{\text{inter-gadged}} \Bigr) \geq 3
			\]
			}
			\only<4>{
			Dijkstra’s Algortihm: $\mathcal{O}(\lvert E_{H} \rvert + \lvert V_{H} \rvert \cdot\func{log} \lvert V_{H} \rvert) = \mathcal{O}(n^{3})$, $\mathcal{O}(n^{2})$ many times
			}
				
		\end{column}
	\end{columns}
	\note[item]{half-chords also form a cycle, solid edges are two-chords to that cycle -> relabeling}
	\note[item]{technique with auxiliary graph is exactly the same, except all weights are non-negative}
	\note[item]{dijkstra, can terminate early if current weight is already $\geq 3$}
\end{frame}

\begin{frame}
	\frametitle{Run Configurations}
\begin{table}
\centering
\begin{tabular}{lccccccc}
\toprule
  & \texttt{Δ-st-1} & \texttt{Δ-st-2} & \texttt{Δ-st-12}	& \texttt{Δ-½}	& \texttt{Δ-2} 	& \texttt{Δ-c}	& \texttt{all}  	\\
\midrule
1 & \texttt{Δ}      & \texttt{Δ}      & \texttt{Δ}      	& \texttt{Δ}	& \texttt{Δ}	& \texttt{Δ}	& \texttt{Δ} 		\\
2 & $\texttt{st}^1$ & $\texttt{st}^2$ & $\texttt{st}^1$ 	& \texttt{half}	& \texttt{two} 	& \texttt{half}	& $\texttt{st}^1$  	\\
3 & —               & —               & $\texttt{st}^2$ 	& —    			& —   		   	& \texttt{two}  & $\texttt{st}^2$  	\\
4 & —               & —               & —               	& —    			& —   		   	& —      		& \texttt{half}     \\
5 & —               & —               & —               	& —    			& — 			& —      		& \texttt{two}      \\
\bottomrule
\end{tabular}
\end{table}
\note[item]{all use Δ first, because they implicitly rely on it}
\note[item]{ordered them by (expected) run time}
\end{frame}

\section{Data}
\begin{frame}
	\frametitle{Natural instances}	
	\begin{itemize}
		\item<1-> \texttt{cetacea} (30) \cite{grotschelCuttingPlaneAlgorithm1989}
		\item<1-> \texttt{cats} (36)
		\item<2-> \texttt{football} (115) \cite{kappesComparativeStudyModern2015}
		\item<2-> \texttt{adjnoun} (112)
		\item<2-> \texttt{polbooks} (105)
		\item<2-> \texttt{lesmis} (77)
		\item<2-> \texttt{dolphins} (62)
		\item<2-> \texttt{karate} (34)
		\item<3-> \texttt{organoid\_[size]\_[difficulty]} (160, 100, 80, 40) \cite{presbergerSegmentationClusteringOrganoids2023}
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Random instances}	
	\begin{itemize}
		\item<1-> Binary \texttt{r\_binary\_[size]} \\
			$\texttt{size} \in \left\{ 25, 50 \right\}$
		\item<2-> Uniform \texttt{r\_uniform\_[size]\_[lb]\_[ub]} \\
			$\texttt{size} \in \left\{ 25, 50 \right\}$ \\
			$(\texttt{lb}, \texttt{ub}) \in \left\{ (-10, 10), (-100, 100), (-10, 100) \right\}$
		\item<3-> Normal \texttt{r\_normal\_[size]\_[mu]\_[sigma]} \\
			$\texttt{size} \in \left\{ 25, 50 \right\}$ \\
			$(\text{\texttt{mu}}, \text{\texttt{sigma}}) \in \left\{ 0, 0.5, 2 \right\} \times \left\{ 0.5, 1, 2 \right\}$

	\end{itemize}
\end{frame}

\section{Empirical Results}
\begin{frame}
	\frametitle{Relative Gap}
	Relative gap of solution $z'$ to the optimal solution $z$
	\[
		\func{gap}(z, z') \coloneqq \frac{\lvert z - z' \rvert}{\lvert z \rvert}
	\]
	\note[item]{case $z=0$ can be ignored}
	\note[item]{only possible to compute when optimal value is known}
\end{frame}

\begin{frame}
	\frametitle{Example: \texttt{adjnoun}}
	\begin{figure}
		\centering
		\resizebox{\linewidth}{!}{
		\includegraphics{analysisCSVs/adjnoun_analysis.png}
		}
	\end{figure}
\end{frame}

\begin{frame}
	\frametitle{Example: \texttt{organoid\_160\_hard}}
	\begin{figure}
		\centering
		\resizebox{\linewidth}{!}{
		\includegraphics{analysisCSVs/organoid160hard_analysis.png}
		}
	\end{figure}
\end{frame}


\begin{frame}
	\frametitle{Run-Times on Natural Instances}
\begin{figure}[H]
	\centering
	\resizebox{0.95\linewidth}{!}{
	\input{analysisCSVs/non_random_time_bars.pgf}}
\end{figure}
\note[item]{Running time of run configurations on non-random instances.}
\note[item]{For run configurations containing a \texttt{st}-separator the results were averaged per instance among the three runs.}
\note[item]{All results are normalized with respect to the \texttt{Δ} run configuration (first column).}
\note[item]{The ordinate is logarthmically scaled.
	Box plots are drawn in the standard way, \ie boxes are from $Q_{1}$ to $Q_{3}$, the blue mark highlights the median, and whiskers extend by $1.5*\var{IQR}$.}
\note[item]{\textcolor{red}{are cycles worth it?}}
\end{frame}

\begin{frame}
	\frametitle{Relative Gaps on Natural Instances}
\begin{figure}[H]
	\centering
	\resizebox{0.95\linewidth}{!}{
	\input{analysisCSVs/non_random_log_gap_bars.pgf}}
\end{figure}
\note[item]{st-separators artifact of measuring integrality with tolerance parameter}
\end{frame}

\begin{frame}
	\frametitle{Run-Times on Random Instances}
\begin{figure}[H]
	\centering
	\resizebox{0.95\linewidth}{!}{
	\input{analysisCSVs/random_time_bars.pgf}}
\end{figure}
\end{frame}

\begin{frame}
	\frametitle{Relative Gaps on Random Instances}
\begin{figure}[H]
	\centering
	\resizebox{0.95\linewidth}{!}{
	\input{analysisCSVs/random_lin_gap_bars.pgf}}
\end{figure}
\note[item]{axis is now linear!}
\note[item]{explain underlying structure in natural instances to show why they are easier}
\end{frame}

\section{Conclusion}

\begin{frame}
	\frametitle{Conclusion}
	\begin{itemize}
		\item \texttt{Δ} and \texttt{st} often sufficient for integral solutions
		\item \texttt{two} and \texttt{half} run longer and do only improve bounds marginally
	\end{itemize}
	\note[item]{Everything with a note: on the instances i tested}
	\note[item]{Personal: great fun, learned much}
	\note[item]{would not have started it if i knew how little i knew ((i)lp, optimization, c++), 10/10}
\end{frame}

\begin{frame}[allowframebreaks]
	\frametitle{Reference}
\printbibliography
\end{frame}

\end{document}
